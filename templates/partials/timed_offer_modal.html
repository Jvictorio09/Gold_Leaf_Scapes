<!-- ═══════════════ 30s VALUE OFFER MODAL ═══════════════ -->
<div id="valueOfferModal" class="value-offer-modal" style="display:none;">
  <div class="value-offer-overlay"></div>
  <div class="value-offer-shell">
    <button type="button" class="value-offer-close" id="valueOfferClose" aria-label="Close">
      <i class="fas fa-times"></i>
    </button>

    <div class="value-offer-grid">
      <!-- Left: Story & benefits -->
      <div class="value-offer-copy">
        <div class="eyebrow value-eyebrow">
          <span class="gold-line" style="width:40px;"></span>
          <span>Let’s Design Your Next Space</span>
        </div>
        <h2 class="value-title">
          What do you need most<br>
          for your <em>villa or garden</em>?
        </h2>
        <p class="value-sub">
          Share a few details and our lead designer will reply with tailored ideas,
          budgets and next steps within <strong>24 hours</strong>—no obligation.
        </p>
        <ul class="value-bullets">
          <li><i class="fas fa-check"></i> 15–minute discovery call to map your priorities</li>
          <li><i class="fas fa-check"></i> High–level concept, timeline & investment range</li>
          <li><i class="fas fa-check"></i> Clear next steps for turning your brief into a build</li>
        </ul>
        <p class="value-note">
          Trusted in Dubai for <strong>3+ years</strong>, <strong>340+ projects</strong> and
          <strong>98% client satisfaction</strong>.
        </p>
      </div>

      <!-- Right: High–conversion form -->
      <div class="value-offer-form-wrap">
        <div class="value-form-card">
          <h3 class="value-form-title">Tell us what you’re planning</h3>
          <p class="value-form-sub">It takes less than a minute.</p>

          <form id="valueOfferForm" class="value-offer-form">
            {% csrf_token %}
            <input type="hidden" name="form_type" value="consultation">
            <!-- Honeypot -->
            <input type="text" name="website" style="position:absolute;left:-9999px;opacity:0;pointer-events:none;" tabindex="-1" autocomplete="off">

            <div class="value-field-group">
              <label for="voName">Full Name <span>*</span></label>
              <input type="text" id="voName" name="name" required>
            </div>

            <div class="value-field-row">
              <div class="value-field-group">
                <label for="voEmail">Email <span>*</span></label>
                <input type="email" id="voEmail" name="email" required>
              </div>
              <div class="value-field-group">
                <label for="voPhone">WhatsApp</label>
                <input type="tel" id="voPhone" name="phone" placeholder="+971 50 200 9863">
              </div>
            </div>

            <div class="value-field-group">
              <label for="voNeed">What do you need help with most? <span>*</span></label>
              <select id="voNeed" name="message" required>
                <option value="">Select one…</option>
                <option>Full villa garden design & build</option>
                <option>Front yard refresh / curb appeal</option>
                <option>Pool, water feature or outdoor structures</option>
                <option>Ongoing landscape maintenance</option>
                <option>Interior greening / living walls</option>
                <option>Not sure yet – I’d like expert advice</option>
              </select>
            </div>

            <div class="value-field-group">
              <label for="voTimeline">Ideal timeline</label>
              <select id="voTimeline" name="timeline">
                <option value="">Select an option…</option>
                <option>Within 4 weeks</option>
                <option>Next 2–3 months</option>
                <option>3–6 months</option>
                <option>Just exploring options</option>
              </select>
            </div>

            <div class="value-checkbox">
              <label>
                <input type="checkbox" id="voConsent" name="terms_accepted" required>
                <span>I’m happy for Gold Leaf Scapes to contact me about this enquiry.</span>
              </label>
            </div>

            <div id="voError" class="value-msg value-error" style="display:none;"></div>
            <div id="voSuccess" class="value-msg value-success" style="display:none;"></div>

            <button type="submit" class="value-submit-btn" id="voSubmit">
              <span class="vo-btn-text">Send my project brief</span>
              <span class="vo-btn-loading" style="display:none;">
                <i class="fas fa-spinner fa-spin"></i> Sending…
              </span>
            </button>
            <p class="value-privacy">
              No spam, ever. We only use your details to reply to this enquiry.
            </p>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .value-offer-modal {
    position: fixed;
    inset: 0;
    z-index: 11000;
    display: none;
    align-items: center;
    justify-content: center;
  }

  .value-offer-overlay {
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at top, rgba(12,12,10,0.85), rgba(12,12,10,0.96));
    backdrop-filter: blur(6px);
  }

  .value-offer-shell {
    position: relative;
    max-width: 1020px;
    width: 92%;
    max-height: 95vh;
    background: radial-gradient(circle at top left, rgba(247,243,236,0.12), transparent 55%), #0e0e0c;
    border-radius: 18px;
    box-shadow: 0 28px 80px rgba(0,0,0,0.7);
    border: 1px solid rgba(201,168,76,0.35);
    padding: 30px 30px 30px 30px;
    z-index: 11001;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  .value-offer-shell::before {
    content: '';
    position: absolute;
    inset: -40%;
    background:
      radial-gradient(circle at 0% 0%, rgba(201,168,76,0.18), transparent 55%),
      radial-gradient(circle at 100% 100%, rgba(92,110,74,0.14), transparent 55%);
    opacity: 0.7;
    pointer-events: none;
  }

  .value-offer-grid {
    position: relative;
    z-index: 1;
    display: grid;
    grid-template-columns: minmax(0, 1.1fr) minmax(0, 1fr);
    gap: 40px;
    align-items: stretch;
    overflow-y: auto;
    flex: 1;
    min-height: 0;
  }

  .value-offer-close {
    position: absolute;
    top: 18px;
    right: 18px;
    width: 34px;
    height: 34px;
    border-radius: 999px;
    border: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(15,15,13,0.7);
    color: rgba(247,243,236,0.8);
    cursor: pointer;
    z-index: 2;
    transition: background 0.2s ease, color 0.2s ease, transform 0.15s ease;
  }

  .value-offer-close:hover {
    background: rgba(201,168,76,0.9);
    color: #0e0e0c;
    transform: translateY(-1px);
  }

  .value-eyebrow span:last-child {
    font-size: 0.72rem;
    letter-spacing: 0.28em;
    text-transform: uppercase;
    color: rgba(247,243,236,0.7);
  }

  .value-title {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(2.1rem, 3.1vw, 3rem);
    font-weight: 300;
    line-height: 1.1;
    color: #f7f3ec;
    margin: 10px 0 16px;
  }

  .value-title em {
    font-style: italic;
    color: rgba(201,168,76,0.95);
  }

  .value-sub {
    font-size: 0.98rem;
    color: rgba(247,243,236,0.78);
    line-height: 1.8;
    max-width: 460px;
    margin-bottom: 18px;
  }

  .value-bullets {
    list-style: none;
    margin: 0 0 14px 0;
    padding: 0;
  }

  .value-bullets li {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    font-size: 0.9rem;
    color: rgba(247,243,236,0.8);
    margin-bottom: 8px;
  }

  .value-bullets i {
    color: rgba(201,168,76,0.95);
    margin-top: 3px;
    font-size: 0.75rem;
  }

  .value-note {
    font-size: 0.85rem;
    color: rgba(247,243,236,0.7);
    margin-top: 8px;
  }

  .value-offer-form-wrap {
    display: flex;
    align-items: stretch;
  }

  .value-form-card {
    width: 100%;
    background: rgba(12,12,10,0.96);
    border-radius: 14px;
    padding: 22px 22px 20px;
    border: 1px solid rgba(201,168,76,0.4);
    box-shadow: 0 18px 40px rgba(0,0,0,0.65);
  }

  .value-form-title {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.4rem;
    font-weight: 400;
    color: #f7f3ec;
    margin-bottom: 4px;
  }

  .value-form-sub {
    font-size: 0.86rem;
    color: rgba(247,243,236,0.65);
    margin-bottom: 14px;
  }

  .value-offer-form {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .value-field-group {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .value-field-row {
    display: grid;
    grid-template-columns: 1.1fr 0.9fr;
    gap: 12px;
  }

  .value-field-group label {
    font-size: 0.78rem;
    letter-spacing: 0.18em;
    text-transform: uppercase;
    color: rgba(247,243,236,0.62);
  }

  .value-field-group label span {
    color: rgba(201,168,76,0.95);
  }

  .value-field-group input,
  .value-field-group select {
    font-family: 'Jost', sans-serif;
    font-size: 0.9rem;
    padding: 10px 11px;
    border-radius: 6px;
    border: 1px solid rgba(201,168,76,0.45);
    background: rgba(10,10,8,0.95);
    color: #f7f3ec;
    outline: none;
    transition: border-color 0.2s, box-shadow 0.2s, background 0.2s;
  }

  .value-field-group input::placeholder {
    color: rgba(247,243,236,0.4);
  }

  .value-field-group input:focus,
  .value-field-group select:focus {
    border-color: rgba(201,168,76,0.95);
    box-shadow: 0 0 0 1px rgba(201,168,76,0.8);
    background: rgba(11,11,9,1);
  }

  .value-checkbox {
    margin-top: 4px;
    font-size: 0.78rem;
    color: rgba(247,243,236,0.7);
    display: flex;
    align-items: flex-start;
  }

  .value-checkbox input[type="checkbox"] {
    margin-right: 8px;
    margin-top: 3px;
  }

  .value-msg {
    font-size: 0.8rem;
    padding: 8px 10px;
    border-radius: 5px;
    margin-top: 2px;
  }

  .value-error {
    background: rgba(190,60,60,0.16);
    color: #ffb5b5;
    border-left: 2px solid rgba(255,115,115,0.9);
  }

  .value-success {
    background: rgba(62,140,80,0.18);
    color: #b9f0c6;
    border-left: 2px solid rgba(120,220,150,0.95);
  }

  .value-submit-btn {
    margin-top: 2px;
    width: 100%;
    border: none;
    border-radius: 999px;
    padding: 13px 16px;
    font-family: 'Jost', sans-serif;
    font-size: 0.86rem;
    font-weight: 600;
    letter-spacing: 0.22em;
    text-transform: uppercase;
    background: linear-gradient(135deg, #c9a84c, #f5e1a0);
    color: #1a1a12;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    box-shadow: 0 14px 36px rgba(0,0,0,0.65);
    transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
  }

  .value-submit-btn:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 20px 46px rgba(0,0,0,0.8);
    background: linear-gradient(135deg, #f5e1a0, #c9a84c);
  }

  .value-submit-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }

  .value-privacy {
    margin-top: 6px;
    font-size: 0.73rem;
    color: rgba(247,243,236,0.55);
    text-align: left;
  }

  @media (max-width: 900px) {
    .value-offer-modal {
      align-items: flex-end;
      padding: 0;
    }
    .value-offer-shell {
      width: 100%;
      max-height: 90vh;
      padding: 0;
      margin: 0;
      border-radius: 20px 20px 0 0;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
      border: none;
      border-top: 1px solid rgba(201,168,76,0.35);
    }
    .value-offer-grid {
      grid-template-columns: 1fr;
      gap: 0;
    }
    .value-offer-copy {
      display: none;
    }
    .value-offer-form-wrap {
      width: 100%;
    }
    .value-form-card {
      background: #0e0e0c;
      border-radius: 20px 20px 0 0;
      padding: 32px 24px 28px;
      border: none;
      border-top: 1px solid rgba(201,168,76,0.35);
      box-shadow: none;
    }
    .value-field-row {
      grid-template-columns: 1fr;
      gap: 14px;
    }
    .value-form-title {
      font-size: 1.5rem;
      margin-bottom: 6px;
      text-align: left;
    }
    .value-form-sub {
      font-size: 0.9rem;
      margin-bottom: 24px;
      text-align: left;
    }
    .value-offer-form {
      gap: 16px;
    }
    .value-field-group {
      gap: 8px;
    }
    .value-field-group label {
      font-size: 0.8rem;
    }
    .value-field-group input,
    .value-field-group select {
      font-size: 1rem;
      padding: 14px 16px;
      border-radius: 8px;
    }
    .value-checkbox {
      font-size: 0.8rem;
      margin-top: 4px;
    }
    .value-submit-btn {
      font-size: 0.9rem;
      letter-spacing: 0.2em;
      padding: 16px 20px;
      margin-top: 8px;
      border-radius: 12px;
    }
    .value-privacy {
      font-size: 0.75rem;
      margin-top: 8px;
      text-align: left;
    }
    .value-offer-close {
      top: 16px;
      right: 16px;
      width: 40px;
      height: 40px;
      background: rgba(15,15,13,0.9);
      backdrop-filter: blur(8px);
    }
  }

  @media (max-width: 640px) {
    .value-offer-modal {
      align-items: flex-end;
    }
    .value-offer-shell {
      max-height: 95vh;
      border-radius: 18px 18px 0 0;
    }
    .value-offer-close {
      top: 14px;
      right: 14px;
      width: 38px;
      height: 38px;
      font-size: 1.2rem;
    }
    .value-form-card {
      padding: 28px 20px 24px;
      border-radius: 18px 18px 0 0;
    }
    .value-form-title {
      font-size: 1.35rem;
      margin-bottom: 6px;
    }
    .value-form-sub {
      font-size: 0.88rem;
      margin-bottom: 22px;
    }
    .value-offer-form {
      gap: 14px;
    }
    .value-field-group {
      gap: 7px;
    }
    .value-field-group label {
      font-size: 0.78rem;
    }
    .value-field-group input,
    .value-field-group select {
      font-size: 0.98rem;
      padding: 13px 15px;
      border-radius: 8px;
    }
    .value-checkbox {
      font-size: 0.78rem;
      line-height: 1.5;
    }
    .value-submit-btn {
      font-size: 0.88rem;
      letter-spacing: 0.18em;
      padding: 15px 18px;
      margin-top: 6px;
      border-radius: 10px;
    }
    .value-privacy {
      font-size: 0.73rem;
      margin-top: 6px;
    }
    .value-msg {
      font-size: 0.85rem;
      padding: 10px 12px;
    }
  }
</style>

<script>
  (function() {
    const modal = document.getElementById('valueOfferModal');
    if (!modal) return;

    const closeBtn = document.getElementById('valueOfferClose');
    const overlay = modal.querySelector('.value-offer-overlay');
    const form = document.getElementById('valueOfferForm');
    const voError = document.getElementById('voError');
    const voSuccess = document.getElementById('voSuccess');
    const voSubmit = document.getElementById('voSubmit');
    const voBtnText = voSubmit ? voSubmit.querySelector('.vo-btn-text') : null;
    const voBtnLoading = voSubmit ? voSubmit.querySelector('.vo-btn-loading') : null;
    const STORAGE_KEY = 'gls_value_offer_dismissed';

    function openValueOfferModal() {
      if (localStorage.getItem(STORAGE_KEY) === '1') return;
      modal.style.display = 'flex';
      document.body.style.overflow = 'hidden';
    }

    function closeValueOfferModal() {
      modal.style.display = 'none';
      document.body.style.overflow = '';
      localStorage.setItem(STORAGE_KEY, '1');
    }

    if (closeBtn) closeBtn.addEventListener('click', closeValueOfferModal);
    if (overlay) overlay.addEventListener('click', closeValueOfferModal);

    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && modal.style.display === 'flex') {
        closeValueOfferModal();
      }
    });

    // Trigger after 30 seconds on site
    function startTimer() {
      if (localStorage.getItem(STORAGE_KEY) === '1') return;
      setTimeout(openValueOfferModal, 30000);
    }
    
    // Start timer when DOM is ready or if already loaded
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', startTimer);
    } else {
      // DOM is already ready
      startTimer();
    }
    
    // Also listen for load event as backup
    window.addEventListener('load', startTimer);

    if (form && voSubmit && voBtnText && voBtnLoading) {
      form.addEventListener('submit', async function(e) {
        e.preventDefault();
        voError.style.display = 'none';
        voSuccess.style.display = 'none';

        voSubmit.disabled = true;
        voBtnText.style.display = 'none';
        voBtnLoading.style.display = 'inline-flex';

        try {
          const formData = new FormData(form);
          const csrfToken = formData.get('csrfmiddlewaretoken');

          const response = await fetch('{% url "contact_form_submit" %}', {
            method: 'POST',
            body: formData,
            headers: {
              'X-CSRFToken': csrfToken
            }
          });

          const data = await response.json();

          if (data.success) {
            voSuccess.textContent = data.message || 'Thank you! Our team will be in touch shortly.';
            voSuccess.style.display = 'block';
            form.reset();
            localStorage.setItem(STORAGE_KEY, '1');

            setTimeout(() => {
              closeValueOfferModal();
            }, 1800);
          } else {
            voError.textContent = data.error || 'Something went wrong. Please check your details and try again.';
            voError.style.display = 'block';
          }
        } catch (err) {
          voError.textContent = 'Network error. Please check your connection and try again.';
          voError.style.display = 'block';
        } finally {
          voSubmit.disabled = false;
          voBtnText.style.display = 'inline';
          voBtnLoading.style.display = 'none';
        }
      });
    }
  })();
</script>


